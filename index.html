<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>බර සහ මිල ගණකය</title>
    <meta name="theme-color" content="#3498db">
    <meta name="mobile-web-app-capable" content="yes">
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; display: flex; justify-content: center; padding: 15px; margin: 0; }
        .container { width: 100%; max-width: 450px; }
        .card, .history-card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 15px; }
        h2 { text-align: center; color: #2c3e50; margin-bottom: 20px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #555; }
        
        /* Input ෆීල්ඩ් එක ක්ලික් කරන්න ලේසි වෙන්න ලොකු කළා */
        input { 
            width: 100%; 
            padding: 15px; 
            border: 2px solid #ddd; 
            border-radius: 10px; 
            margin-bottom: 15px; 
            font-size: 18px; 
            box-sizing: border-box;
            -webkit-appearance: none; /* Mobile වල ලස්සනට පේන්න */
        }
        
        input:focus { border-color: #3498db; outline: none; background: #fff; }
        .weight-inputs { display: flex; gap: 10px; }
        .weight-inputs div { flex: 1; }
        .result-box { background: #e8f5e9; padding: 15px; text-align: center; border-radius: 10px; margin-top: 10px; border: 1px solid #2ecc71; }
        .total-price { font-size: 26px; font-weight: bold; color: #27ae60; }
        button { width: 100%; padding: 15px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; margin-top: 10px; font-size: 16px; }
        .add-btn { background: #3498db; color: white; }
        .clear-btn { background: #e74c3c; color: white; }
        .history-list { list-style: none; padding: 0; max-height: 250px; overflow-y: auto; }
        .history-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee; }
    </style>
</head>
<body>

<div class="container">
    <div class="card">
        <h2>මිල ගණකය</h2>
        
        <label>කිලෝවක මිල (රු.):</label>
        <input type="number" id="pricePerKg" inputmode="decimal" placeholder="0.00" oninput="calculate()" autofocus>
        
        <div class="weight-inputs">
            <div>
                <label>කිලෝ (kg):</label>
                <input type="number" id="kgInput" inputmode="numeric" placeholder="0" oninput="calculate()">
            </div>
            <div>
                <label>ග්‍රෑම් (g):</label>
                <input type="number" id="gInput" inputmode="numeric" placeholder="0" oninput="calculate()">
            </div>
        </div>

        <div class="result-box">
            <div>මුළු මුදල:</div>
            <div class="total-price">රු. <span id="total">0.00</span></div>
        </div>

        <button class="add-btn" onclick="addToHistory()">ලැයිස්තුවට එක් කරන්න</button>
        <button class="clear-btn" onclick="clearFields()">මකන්න</button>
    </div>

    <div class="history-card" id="historyCard" style="display: none;">
        <h3>පෙර ගණනය කිරීම්</h3>
        <ul id="historyList" class="history-list"></ul>
        <div style="text-align: right; font-weight: bold; margin-top: 10px; font-size: 18px;">මුළු එකතුව: රු. <span id="grandTotal">0.00</span></div>
        <button class="clear-btn" onclick="clearHistory()">History මකන්න</button>
    </div>
</div>

<script>
    let historyData = [];

    function calculate() {
        const pricePerKg = parseFloat(document.getElementById('pricePerKg').value) || 0;
        const kg = parseFloat(document.getElementById('kgInput').value) || 0;
        const g = parseFloat(document.getElementById('gInput').value) || 0;
        const totalWeight = kg + (g / 1000);
        const totalPrice = totalWeight * pricePerKg;
        document.getElementById('total').innerText = totalPrice.toFixed(2);
        return { pricePerKg, kg, g, totalPrice };
    }

    function addToHistory() {
        const data = calculate();
        if (data.totalPrice <= 0) return;
        historyData.push(data.totalPrice);
        const list = document.getElementById('historyList');
        const item = document.createElement('li');
        item.className = 'history-item';
        item.innerHTML = `<span>${data.kg}kg ${data.g}g (රු.${data.pricePerKg})</span> <b>රු. ${data.totalPrice.toFixed(2)}</b>`;
        list.prepend(item);
        const grandTotal = historyData.reduce((a, b) => a + b, 0);
        document.getElementById('grandTotal').innerText = grandTotal.toLocaleString('en-US', {minimumFractionDigits: 2});
        document.getElementById('historyCard').style.display = 'block';
        clearFields();
    }

    function clearFields() {
        document.getElementById('kgInput').value = '';
        document.getElementById('gInput').value = '';
        document.getElementById('total').innerText = '0.00';
        // ආපසු පළමු කොටුවට Focus කිරීම (කීබෝඩ් එක ඕපන්ව තබා ගැනීමට)
        document.getElementById('kgInput').focus();
    }

    function clearHistory() {
        if(confirm("හිස්ට්‍රිය මකන්නද?")) {
            historyData = [];
            document.getElementById('historyList').innerHTML = '';
            document.getElementById('historyCard').style.display = 'none';
        }
    }
</script>
</body>
</html>
